# Cистема управления платежами на FastAPI

Этот проект представляет собой готовое приложение для разработки масштабируемого веб-приложений на основе **FastAPI** 
для управления платежами пользователей, с панелью администратора. Приложение позволяет добавлять, удалять, пользователей, обновлять и получать информацию о их балансе. 
Проект включает модульную архитектуру, поддерживает гибкое логирование с **loguru**, и взаимодействие с базой данных 
через **SQLAlchemy** с асинхронной поддержкой. Система миграций **Alembic** упрощает работу со схемой базы данных.

## Стек технологий

- **Веб-фреймворк**: FastAPI
- **ORM**: SQLAlchemy
- **База данных**: PostgeSQL
- **Система миграций**: Alembic

## Зависимости проекта

- `fastapi[all]==0.115.0` - высокопроизводительный веб-фреймворк
- `pydantic==2.9.2` - валидация данных
- `uvicorn==0.31.0` - ASGI-сервер
- `jinja2==3.1.4` - шаблонизатор
- `SQLAlchemy==2.0.35` - ORM для работы с базами данных
- `alembic==1.13.3` - управление миграциями базы данных
- `loguru==0.7.2` - красивое и удобное логирование
- `pytest-asyncio~=0.24.0` - ассинхронный плагин pytest


### Основные модули

- **app/account** - Модуль для CRUD операций со счетами:
    - **dao.py**: Объект доступа к данным для работы со счетами
    - **models.py**: Модели данных для счетов
    - **router.py**: Маршрутизация запросов, связанных с CRUD  операциями
    - **schemas.py**: Схемы Pydantic для валидации запросов и ответов
- **app/admin_panel** - Модуль для CRUD операций панели администраторов:
     - **router.py**: Маршрутизация запросов, связанных с CRUD  операциями
- **app/payment** - Модуль для CRUD операций с платежами:
    - **dao.py**: Объект доступа к данным для работы с платежами
    - **models.py**: Модели данных для платежей
    - **router.py**: Маршрутизация запросов, связанных с CRUD  операциями
    - **schemas.py**: Схемы Pydantic для валидации запросов и ответов
- **app/users** - Модуль для CRUD операций с пользователями:
    - **dao.py**: Объект доступа к данным для работы с пользователями
    - **models.py**: Модели данных для пользователей
    - **router.py**: Маршрутизация запросов, связанных с CRUD  операциями
    - **schemas.py**: Схемы Pydantic для валидации запросов и ответов
    - **auth.py**: Аутентификация и авторизация пользователей


- **app/dao** - Базовый DAO для доступа к данным приложения.
    - **base.py**: Общие методы CRUD для работы с БД

- **app/migration** - Управление миграциями базы данных с помощью Alembic:
    - **versions/**: Файлы миграций
    - **env.py**: Конфигурация среды Alembic


- **config.py** - Файл конфигурации с параметрами приложения, загружаемыми из `.env`.

- **database.py** - Управление подключением и сессиями SQLAlchemy.

- **main.py** - Запуск приложения, настройка маршрутов и начальных параметров.


## Запуск приложения через docker-compose.yaml
1. Клонируйте репозиторий:

   ```bash
   git clone https://github.com/CapitanGrant/PaymentService
   cd PaymentService
   ```
  
2. Запустите проект с помощью Docker Compose

    ```bash
   docker-compose up --build
   ```
4. Перейдите в браузере по адресу:
   
   ```
   http://localhost:8001/docs
   ```
5. Логин и пароль созданных по умолчанию пользователя и администратора:
   
   ```
   user
   "email": "user123@example.com"
   "password": "userpassword"

   admin
   "email": "admin@example.com"
   "password": "adminpassword"
   
   ```

## Запуск приложения без использования docker-compose.yaml
1. Клонируйте репозиторий:

   ```bash
   git clone https://github.com/CapitanGrant/PaymentService
   ```

2. Установите зависимости:

   ```bash
   pip install -r requirements.txt
   ```


3. Запустите docker контейнер c PostgreSQL:

   ```bash
   docker-compose up -d postgres
   ```

4. Примените миграции:

   ```bash
   alembic upgrade head
   ```
5. Запустите приложение с Uvicorn:

   ```bash
   uvicorn app.main:app --reload
   ```

6. Для чтения документации перейдите по ссылке
   ```браузер
   http://127.0.0.1:8000/docs#/
   ```
7. Логин и пароль созданных по умолчанию пользователя и администратора:
   
   ```
   user
   "email": "user123@example.com"
   "password": "userpassword"

   admin
   "email": "admin@example.com"
   "password": "adminpassword"
   
   ```
